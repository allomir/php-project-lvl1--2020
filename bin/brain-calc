#!/usr/bin/env php

<?php

require_once __DIR__ . '/../vendor/autoload.php';

use Brain\Games\Engine;

use function Brain\Games\Engine\getStatuses;
use function cli\line;
use function cli\prompt;

$numRounds = Engine\getNumRounds();

line(Engine\welcome());
# побочный эффект STDIN
$name = Engine\getName();
line(Engine\helloUser($name));

function qustions($name)
{
    $question = Engine\getQuestion();
    line($question);
    $result = Engine\getResult($question);
    # побочный эффект STDIN
    $answer = Engine\getAnswer();
    return Engine\getStatus($name, $result, $answer);
}

$isCorrect = true;
while ($isCorrect === true && $numRounds) {
    $status = qustions($name);
    line($status);

    $isCorrect = $status === Engine\getStatuses()['right'];
    $numRounds--;
}

if ($isCorrect === true) {
    line(Engine\getCongratulations($name));
}
